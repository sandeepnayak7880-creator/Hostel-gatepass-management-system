<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gate Pass Management System - Secure Hostel Management</title>
    <meta name="description" content="Complete gate pass management system with QR scanning, role-based access, and real-time notifications">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner hidden">
        <div class="spinner">
            <i class="fas fa-spinner fa-spin"></i>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notification" class="notification hidden">
        <div class="notification-content">
            <i id="notificationIcon" class="fas fa-info-circle"></i>
            <span id="notificationText"></span>
        </div>
    </div>

    <!-- Welcome Page -->
    <div id="welcomePage" class="page active">
        <div class="welcome-container">
            <div class="welcome-header">
                <h1><i class="fas fa-door-closed"></i> Gate Pass Management System</h1>
                <p>Secure, efficient, and real-time hostel management</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <i class="fas fa-qrcode"></i>
                    <h3>QR Code Scanning</h3>
                    <p>Real-time entry/exit tracking with QR codes</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-bell"></i>
                    <h3>Instant Notifications</h3>
                    <p>Instant alerts for parents, students, and staff</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-users"></i>
                    <h3>Multi-Role Access</h3>
                    <p>Students, Parents, Wardens, Security, Admins</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-mobile-alt"></i>
                    <h3>Cross-Platform</h3>
                    <p>Access anywhere, anytime on any device</p>
                </div>
            </div>
            
            <div class="welcome-actions">
                <button id="loginBtn" class="btn btn--primary btn--lg">
                    <i class="fas fa-sign-in-alt"></i> Login to Account
                </button>
                <button id="registerBtn" class="btn btn--outline btn--lg">
                    <i class="fas fa-user-plus"></i> Create New Account
                </button>
            </div>
        </div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="page">
        <div class="auth-container">
            <div class="auth-header">
                <button id="loginBackBtn" class="btn-back">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Login to Your Account</h2>
            </div>
            
            <div class="auth-form">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginRole" class="form-label">
                            <i class="fas fa-user-tag"></i> Select Your Role
                        </label>
                        <select id="loginRole" class="form-control" required>
                            <option value="">Choose your role</option>
                            <option value="student">Student</option>
                            <option value="parent">Parent</option>
                            <option value="security">Security</option>
                            <option value="warden">Warden</option>
                            <option value="admin">Administrator</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginCredential" class="form-label">
                            <i class="fas fa-envelope"></i> Email Address
                        </label>
                        <input type="email" id="loginCredential" class="form-control" placeholder="Enter your email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginPassword" class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <div class="password-input">
                            <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
                            <button type="button" class="password-toggle" data-target="loginPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="rememberMe">
                            <span>Remember me</span>
                        </label>
                        <a href="#" id="forgotPasswordLink">Forgot Password?</a>
                    </div>
                    
                    <button type="submit" class="btn btn--primary btn--full-width">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    
                    <div id="loginStatus" class="status-message"></div>
                </form>
                
                <div class="auth-footer">
                    <p>Don't have an account? <a href="#" id="goToRegisterLink">Register here</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Registration Page -->
    <div id="registerPage" class="page">
        <div class="auth-container">
            <div class="auth-header">
                <button id="registerBackBtn" class="btn-back">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Create New Account</h2>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-step active">
                        <div class="step-number">1</div>
                        <div class="step-label">Role Selection</div>
                    </div>
                    <div class="progress-step">
                        <div class="step-number">2</div>
                        <div class="step-label">Personal Details</div>
                    </div>
                    <div class="progress-step">
                        <div class="step-number">3</div>
                        <div class="step-label">Verification</div>
                    </div>
                </div>
            </div>
            
            <!-- Step 1: Role Selection -->
            <div id="registerStep1" class="register-step active">
                <div class="auth-form">
                    <h3>Select Your Role</h3>
                    <p>Choose the role that best describes you</p>
                    
                    <div class="role-grid">
                        <div class="role-card" data-role="student">
                            <i class="fas fa-graduation-cap"></i>
                            <h4>Student</h4>
                            <p>Request gate passes and scan QR codes</p>
                        </div>
                        <div class="role-card" data-role="parent">
                            <i class="fas fa-home"></i>
                            <h4>Parent</h4>
                            <p>Monitor your child's activities</p>
                        </div>
                        <div class="role-card" data-role="security">
                            <i class="fas fa-shield-alt"></i>
                            <h4>Security</h4>
                            <p>Scan QR codes and monitor entry/exit</p>
                        </div>
                        <div class="role-card" data-role="warden">
                            <i class="fas fa-user-tie"></i>
                            <h4>Warden</h4>
                            <p>Manage and approve student requests</p>
                        </div>
                        <div class="role-card" data-role="admin">
                            <i class="fas fa-cogs"></i>
                            <h4>Administrator</h4>
                            <p>Full system control and management</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 2: Personal Details -->
            <div id="registerStep2" class="register-step">
                <div class="auth-form">
                    <h3 id="step2Title">Personal Details</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fullName" class="form-label">
                                <i class="fas fa-user"></i> Full Name *
                            </label>
                            <input type="text" id="fullName" class="form-control" placeholder="Enter your full name" required>
                            <div class="field-feedback" id="fullNameFeedback"></div>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">
                                <i class="fas fa-envelope"></i> Email Address *
                            </label>
                            <input type="email" id="email" class="form-control" placeholder="Enter your email" required>
                            <div class="field-feedback" id="emailFeedback"></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone" class="form-label">
                                <i class="fas fa-phone"></i> Phone Number *
                            </label>
                            <input type="tel" id="phone" class="form-control" placeholder="Enter your phone number" required>
                            <div class="field-feedback" id="phoneFeedback"></div>
                        </div>
                        <div class="form-group">
                            <label for="username" class="form-label">
                                <i class="fas fa-at"></i> Username *
                            </label>
                            <input type="text" id="username" class="form-control" placeholder="Choose a username" required>
                            <div class="field-feedback" id="usernameFeedback"></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="password" class="form-label">
                                <i class="fas fa-lock"></i> Password *
                            </label>
                            <div class="password-input">
                                <input type="password" id="password" class="form-control" placeholder="Create a password" required>
                                <button type="button" class="password-toggle" data-target="password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="password-strength">
                                <div class="strength-bar">
                                    <div class="strength-fill" id="strengthFill"></div>
                                </div>
                                <div class="field-feedback" id="passwordFeedback"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword" class="form-label">
                                <i class="fas fa-lock"></i> Confirm Password *
                            </label>
                            <div class="password-input">
                                <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm your password" required>
                                <button type="button" class="password-toggle" data-target="confirmPassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="field-feedback" id="confirmPasswordFeedback"></div>
                        </div>
                    </div>
                    
                    <!-- Role-specific fields will be inserted here -->
                    <div id="roleSpecificFields"></div>
                    
                    <div class="auto-save-indicator" id="autoSaveIndicator">
                        <i class="fas fa-check-circle"></i>
                        <span>Form auto-saved</span>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" id="backToStep1Btn" class="btn btn--outline">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button type="button" id="proceedToStep3Btn" class="btn btn--primary">
                            Continue <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Step 3: OTP Verification -->
            <div id="registerStep3" class="register-step">
                <div class="auth-form">
                    <div class="otp-container">
                        <div class="otp-info">
                            <i class="fas fa-mobile-alt"></i>
                            <h3>Verify Your Account</h3>
                            <p>We've sent an OTP to your phone number</p>
                            <div class="phone-display" id="phoneDisplay"></div>
                        </div>
                        
                        <div class="otp-display">
                            <p>Your OTP Code:</p>
                            <div class="otp-code" id="otpCode"></div>
                            <p><small>Use this code to verify your account</small></p>
                        </div>
                        
                        <div class="form-group">
                            <label for="otpInput" class="form-label">
                                <i class="fas fa-key"></i> Enter OTP Code
                            </label>
                            <input type="text" id="otpInput" class="form-control otp-input" placeholder="Enter 6-digit code" maxlength="6" required>
                        </div>
                        
                        <div class="otp-actions">
                            <button type="button" id="copyOTPBtn" class="btn btn--outline">
                                <i class="fas fa-copy"></i> Copy Code
                            </button>
                            <button type="button" id="resendOTPBtn" class="btn btn--outline">
                                <i class="fas fa-redo"></i> Resend OTP
                            </button>
                        </div>
                        
                        <button type="button" id="verifyOTPBtn" class="btn btn--primary btn--full-width">
                            <i class="fas fa-check"></i> Verify & Complete Registration
                        </button>
                        
                        <div class="form-actions">
                            <button type="button" id="backToStep2Btn" class="btn btn--outline">
                                <i class="fas fa-arrow-left"></i> Back to Details
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="page dashboard">
        <div class="dashboard-header">
            <div class="user-info">
                <h2 id="studentName">Welcome, Student</h2>
                <p id="studentInfo">Student Dashboard</p>
            </div>
            <button id="studentLogoutBtn" class="btn btn--outline">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
        
        <div class="dashboard-content">
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-door-open"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="activePassesCount">0</h3>
                        <p>Gate Passes</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="studentStatusText">Current Status</h3>
                        <p>In/Out Status</p>
                    </div>
                </div>
            </div>
            
            <!-- Action Cards -->
            <div class="action-cards">
                <div class="action-card" data-action="showGatePassRequest">
                    <i class="fas fa-plus-circle"></i>
                    <h4>Request Gate Pass</h4>
                    <p>Create new gate pass request</p>
                </div>
                <div class="action-card" data-action="showQRScanner">
                    <i class="fas fa-qrcode"></i>
                    <h4>Scan QR Code</h4>
                    <p>Log entry/exit with QR scan</p>
                </div>
                <div class="action-card" data-action="showFoodSchedule">
                    <i class="fas fa-utensils"></i>
                    <h4>Food Schedule</h4>
                    <p>View daily meal timings</p>
                </div>
                <div class="action-card" data-action="showComplaints">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h4>Complaints</h4>
                    <p>Lodge hostel complaints</p>
                </div>
            </div>
            
            <!-- Recent Activity -->
            <div class="recent-activity">
                <h3><i class="fas fa-history"></i> Recent Activity</h3>
                <div class="activity-list" id="studentRecentActivity">
                    <div class="activity-item">
                        <i class="fas fa-info-circle"></i>
                        <div class="activity-content">
                            <p>No recent activity</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Parent Dashboard -->
    <div id="parentDashboard" class="page dashboard">
        <div class="dashboard-header">
            <div class="user-info">
                <h2 id="parentName">Welcome, Parent</h2>
                <p id="parentInfo">Parent Dashboard</p>
            </div>
            <button id="parentLogoutBtn" class="btn btn--outline">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
        
        <div class="dashboard-content">
            <!-- Child Info Card -->
            <div class="child-info-card">
                <h3><i class="fas fa-child"></i> Child Information</h3>
                <div id="childInfoContent">
                    <div class="action-card" data-action="linkChild">
                        <i class="fas fa-link"></i>
                        <h4>Link Child Account</h4>
                        <p>Link your child's account to view their information</p>
                    </div>
                </div>
            </div>
            
            <!-- Notifications -->
            <div class="notifications-section">
                <h3><i class="fas fa-bell"></i> Notifications</h3>
                <div class="notifications-list" id="parentNotifications">
                    <div class="notification-item">
                        <i class="fas fa-info-circle"></i>
                        <div class="notification-content">
                            <p>No notifications yet</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Child Activity -->
            <div class="child-activity">
                <h3><i class="fas fa-chart-line"></i> Child Activity</h3>
                <div class="timeline-list" id="childActivityTimeline">
                    <div class="timeline-item">
                        <i class="fas fa-info-circle"></i>
                        <div class="timeline-content">
                            <p>No activity to display</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Security Dashboard -->
    <div id="securityDashboard" class="page dashboard">
        <div class="dashboard-header">
            <div class="user-info">
                <h2 id="securityName">Welcome, Security</h2>
                <p id="securityInfo">Security Dashboard</p>
            </div>
            <button id="securityLogoutBtn" class="btn btn--outline">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
        
        <div class="dashboard-content">
            <!-- QR Code Section -->
            <div class="qr-section">
                <div class="qr-code-card">
                    <h3><i class="fas fa-qrcode"></i> Security QR Code</h3>
                    <p>Students scan this code for entry/exit</p>
                    <div class="qr-code-display">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=GP-SEC-2025-001" alt="Security QR Code">
                    </div>
                    <p><small>Code: GP-SEC-2025-001</small></p>
                </div>
                
                <div class="live-monitoring">
                    <h3><i class="fas fa-eye"></i> Live Monitoring</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="todayScans">0</h3>
                                <p>Today's Scans</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-door-open"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="studentsOut">0</h3>
                                <p>Students Out</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scan-list" id="recentScans">
                        <div class="scan-item">
                            <i class="fas fa-info-circle"></i>
                            <div class="scan-content">
                                <p>No recent scans</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Warden Dashboard -->
    <div id="wardenDashboard" class="page dashboard">
        <div class="dashboard-header">
            <div class="user-info">
                <h2 id="wardenName">Welcome, Warden</h2>
                <p id="wardenInfo">Warden Dashboard</p>
            </div>
            <button id="wardenLogoutBtn" class="btn btn--outline">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
        
        <div class="dashboard-content">
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalStudentsCount">0</h3>
                        <p>Total Students</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="pendingApprovalsCount">0</h3>
                        <p>Pending Approvals</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="activeGatePassesCount">0</h3>
                        <p>Active Gate Passes</p>
                    </div>
                </div>
            </div>
            
            <!-- Management Sections -->
            <div class="management-sections">
                <div class="management-card" data-action="showPendingRegistrations">
                    <i class="fas fa-user-plus"></i>
                    <h4>Pending Registrations</h4>
                    <p>Approve new user registrations</p>
                    <div class="badge" id="pendingRegsBadge">0</div>
                </div>
                <div class="management-card" data-action="showGatePassRequests">
                    <i class="fas fa-clipboard-list"></i>
                    <h4>Gate Pass Requests</h4>
                    <p>Review and approve gate passes</p>
                    <div class="badge" id="gatePassBadge">0</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="page dashboard">
        <div class="dashboard-header">
            <div class="user-info">
                <h2 id="adminName">Welcome, Administrator</h2>
                <p id="adminInfo">System Administration</p>
            </div>
            <button id="adminLogoutBtn" class="btn btn--outline">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
        
        <div class="dashboard-content">
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalUsersCount">0</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="approvedUsersCount">0</h3>
                        <p>Approved Users</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="systemAlertsCount">0</h3>
                        <p>System Alerts</p>
                    </div>
                </div>
            </div>
            
            <!-- Admin Sections -->
            <div class="admin-sections">
                <div class="management-card" data-action="showUserManagement">
                    <i class="fas fa-users-cog"></i>
                    <h4>User Management</h4>
                    <p>Manage all registered users</p>
                </div>
                <div class="management-card" data-action="showSystemAnalytics">
                    <i class="fas fa-chart-bar"></i>
                    <h4>System Analytics</h4>
                    <p>View detailed system statistics</p>
                </div>
                <div class="management-card" data-action="showAuditLog">
                    <i class="fas fa-clipboard-list"></i>
                    <h4>Audit Log</h4>
                    <p>Track all system activities</p>
                </div>
                <div class="management-card" data-action="showSystemSettings">
                    <i class="fas fa-cog"></i>
                    <h4>System Settings</h4>
                    <p>Configure system parameters</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Modal Title</h3>
                <button id="modalCloseBtn" class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                Modal content goes here...
            </div>
            <div class="modal-footer" id="modalFooter">
                <button class="btn btn--outline" onclick="closeModal()">Cancel</button>
                <button class="btn btn--primary">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, getDocs, collection, addDoc, updateDoc, deleteDoc, query, where, orderBy, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // YOUR FIREBASE CONFIG - REPLACE WITH YOUR ACTUAL VALUES
        const firebaseConfig = {
            apiKey: "AIzaSyB9oFRirqhUG2Gb0-QtAEahRA8QzdBRSjI",
            authDomain: "gate-pass-system-873be.firebaseapp.com",
            projectId: "gate-pass-system-873be",
            storageBucket: "gate-pass-system-873be.appspot.com",
            messagingSenderId: "992556341001",
            appId: "1:992556341001:web:939a69eb2ff0e1ebc9e5d8",
            measurementId: "G-2ZNP6881YR"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Make Firebase available globally
        window.firebase = {
            app,
            auth,
            db,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            doc,
            setDoc,
            getDoc,
            getDocs,
            collection,
            addDoc,
            updateDoc,
            deleteDoc,
            query,
            where,
            orderBy,
            onSnapshot
        };
    </script>

    <!-- Firebase-enabled JavaScript -->
    <script src="app.js"></script>
</body>
</html>